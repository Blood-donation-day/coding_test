## 여러기준으로 정렬하기

SELECT ANIMAL_ID, NAME, DATETIME
FROM ANIMAL_INS
ORDER BY NAME ASC, DATETIME DESC

## 조건에 맞는 회원수 구하기

SELECT COUNT(AGE) AS USERS
FROM USER_INFO
WHERE AGE BETWEEN 20 AND 29 AND
JOINED BETWEEN '2021-01-01' AND '2021-12-31'

## 평균 일일 대여 요금 구하기

SELECT ROUND(AVG(DAILY_FEE), 0) AS AVERAGE_FEE
FROM CAR_RENTAL_COMPANY_CAR
WHERE CAR_TYPE = 'SUV'

## 중복 제거하기

SELECT COUNT(DISTINCT(NAME)) AS count
FROM ANIMAL_INS
WHERE NAME IS NOT NULL

## 동명 동물 수 찾기 (GEOUP BY)

SELECT NAME, COUNT(_) AS COUNT
FROM ANIMAL_INS
WHERE NAME IS NOT NULL
GROUP BY NAME
HAVING COUNT(_) >= 2
ORDER BY NAME

## NULL 처리하기

SELECT ANIMAL_TYPE,

CASE
WHEN NAME IS NULL THEN 'No name'
ELSE NAME
END AS NAME,

SEX_UPON_INTAKE
FROM ANIMAL_INS

## 카테고리 별 상품 개수 구하기

SELECT SUBSTR(PRODUCT_CODE, 1, 2) AS CATEGORY, COUNT(\*) AS PRODUCTS
FROM PRODUCT
GROUP BY CATEGORY
HAVING COUNT(CATEGORY)
ORDER BY CATEGORY

## 중성화 여부 파악하기

SELECT ANIMAL_ID, NAME,
CASE
WHEN SEX_UPON_INTAKE LIKE 'intact%' THEN 'X'
ELSE 'O'
END AS 중성화
FROM ANIMAL_INS

## 개와 고양이의 수

SELECT ANIMAL_TYPE, COUNT(\*) AS COUNT
FROM ANIMAL_INS
WHERE ANIMAL_TYPE = 'DOG' OR ANIMAL_TYPE = 'CAT'
GROUP BY ANIMAL_TYPE
ORDER BY ANIMAL_TYPE

## 진료과별 총 예약 횟수 출력하기

SELECT MCDP_CD AS 진료과코드, COUNT(APNT_YMD) AS 5월예약건수
FROM APPOINTMENT
WHERE APNT_YMD LIKE '2022-05%'
GROUP BY MCDP_CD
ORDER BY COUNT(APNT_YMD), MCDP_CD

## 입양 시각 구하기

SELECT HOUR(DATETIME) AS HOUR, COUNT(\*) AS COUNT
FROM ANIMAL_OUTS
WHERE HOUR(DATETIME) BETWEEN '9' AND '19'
GROUP BY HOUR(DATETIME)
ORDER BY HOUR(DATETIME)

## 카테고리 별 도서 판매량 집계하기

SELECT CATEGORY, SUM(SALES) AS TOTAL_SALES

FROM BOOK AS B
JOIN BOOK_SALES AS S
ON B.BOOK_ID = S.BOOK_ID

WHERE SALES_DATE LIKE '2022-01%'
GROUP BY CATEGORY
ORDER BY CATEGORY

## 오랜 기간 보호한 동물(1)

SELECT I.NAME, I.DATETIME
FROM ANIMAL_INS AS I
LEFT JOIN ANIMAL_OUTS AS O
USING(ANIMAL_ID)
WHERE SEX_UPON_OUTCOME IS NULL
ORDER BY I.DATETIME
LIMIT 3

## 상품 별 오프라인 매출 구하기

SELECT PRODUCT_CODE, SUM(SALES_AMOUNT)\*P.PRICE AS SALES
FROM PRODUCT AS P
JOIN OFFLINE_SALE AS O
ON P.PRODUCT_ID = O.PRODUCT_ID
GROUP BY PRODUCT_CODE
ORDER BY SALES DESC, PRODUCT_CODE ASC

## 조건에 맞는 도서와 저자 리스트 출력하기

SELECT BOOK_ID, AUTHOR_NAME, DATE_FORMAT(PUBLISHED_DATE, '%Y-%m-%d') AS PUBLISHED_DATE
FROM BOOK AS B
JOIN AUTHOR AS A
ON B.AUTHOR_ID = A.AUTHOR_ID
WHERE CATEGORY = '경제'
ORDER BY PUBLISHED_DATE ASC

## 조건별로 분류하여 주문상태 출력하기

SELECT ORDER_ID, PRODUCT_ID, DATE_FORMAT(OUT_DATE, '%Y-%m-%d') AS OUT_DATE,
CASE
WHEN OUT_DATE > '2022-05-01' THEN '출고대기'
WHEN OUT_DATE <= '2022-05-01' THEN '출고완료'
ELSE '출고미정'
END AS 출고여부
FROM FOOD_ORDER
ORDER BY ORDER_ID

## 있었는데요 없었습니다.

SELECT A.ANIMAL_ID, A.NAME
FROM ANIMAL_INS AS A
JOIN ANIMAL_OUTS AS B
ON A.ANIMAL_ID = B.ANIMAL_ID
WHERE A.DATETIME > B.DATETIME
ORDER BY A.DATETIME

## 오랜 기간 보호한 동물(2)

SELECT B.ANIMAL_ID, B.NAME
FROM ANIMAL_INS AS A
JOIN ANIMAL_OUTS AS B
ON A.ANIMAL_ID = B.ANIMAL_ID
ORDER BY DATEDIFF(B.DATETIME, A.DATETIME) DESC
LIMIT 2

## 특정 기간동안 대여 가능한 자동차들의 대여비용 구하기

SELECT CAR*ID, A.CAR_TYPE,
FLOOR(DAILY_FEE * 30 \_ (1 - DISCOUNT_RATE/100)) AS FEE
FROM CAR_RENTAL_COMPANY_CAR AS A
JOIN CAR_RENTAL_COMPANY_DISCOUNT_PLAN AS B
ON A.CAR_TYPE = B.CAR_TYPE

WHERE A.CAR_ID NOT IN (
SELECT CAR_ID
FROM CAR_RENTAL_COMPANY_RENTAL_HISTORY
WHERE START_DATE <= '2022-11-30' AND END_DATE >= '2022-11-01'
)
AND B.DURATION_TYPE = '30일 이상'

HAVING FEE >= 500000 AND FEE < 2000000
ORDER BY FEE DESC, CAR_TYPE ASC, CAR_ID DESC

## 5월 식품들의 총매출 조회하기

SELECT A.PRODUCT_ID, PRODUCT_NAME, SUM(PRICE \* AMOUNT) AS TOTAL_SALES
FROM FOOD_PRODUCT AS A
JOIN FOOD_ORDER AS B
ON A.PRODUCT_ID = B.PRODUCT_ID
WHERE PRODUCE_DATE LIKE '2022-05%'
GROUP BY PRODUCT_NAME
ORDER BY TOTAL_SALES DESC, PRODUCT_ID ASC

## 그룹별 조건에 맞는 식당 목록 출력하기

SELECT MEMBER_NAME, REVIEW_TEXT, DATE_FORMAT(REVIEW_DATE, '%Y-%m-%d') AS REVIEW_DATE
FROM MEMBER_PROFILE AS A
JOIN REST_REIVEW AS B
ON A.MEMBER_ID = B.MEMBER_ID
WHERE MEMBER_NAME = (
SELECT MEMBER_NAME
FROM MEMBER_PROFILE AS A
JOIN REST_REVIEW AS B
ON A.MEMBER_ID = B.MEMBER_ID
GROUP BY MEMBER_NAME
ORDER BY COUNT(\*) DESC
LIMIT 1
)
ORDER BY REVIEW_DATE, REVIEW_TEXT

## 없어진 기록 찾기

SELECT B.ANIMAL_ID, B.NAME
FROM ANIMAL_INS AS A
RIGHT JOIN ANIMAL_OUTS AS B
ON A.ANIAML_ID = B.ANIMAL_ID
WHERE A.NAME IS NULL AND B.NAME IS NOT NULL

## 보호소에서 중성화한 동물

SELECT A.ANIMAL_ID, A.ANIMAL_TYPE, A.NAME
FROM ANIMAL_INS AS A
JOIN ANIMAL_OUTS AS B
ON A.ANIAML_ID = B.ANIMAL_ID
WHERE A.SEX_UPON_INTAKE LIKE 'Intact%'
AND (B.SEX_UPON_OUTCOME LIKE 'Neutered%' OR B.SEX_UPON_OUTCOME LIKE 'Spayed%')
ORDER BY A.ANIAML_ID
